<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Private Letter • Open with password</title>

  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>

    :root{
      --bg1:#1a0d2e;
      --bg2:#16213e;
      --accent:#ff6b9d;
      --accent-light:#ffb3d1;
      --flower-pink:#ff7eb3;
      --flower-yellow:#ffd93d;
      --flower-purple:#b388ff;
      --flower-orange:#ff8a65;
    }

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;overflow-x:hidden;}

    body{
      background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 50%,#2d1b3d 100%);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
      min-height:100vh;
      position:relative;
    }

    /* Decorative flowers */
    .flower-decoration {
      position: fixed;
      pointer-events: none;
      z-index: 1;
    }

    .flower {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      position: relative;
      animation: float 6s ease-in-out infinite;
    }

    .flower::before,
    .flower::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
    }

    .flower::before {
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      background: inherit;
    }

    .flower::after {
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      background: inherit;
    }

    .flower-1 { background: var(--flower-pink); top: 10%; left: 5%; animation-delay: 0s; }
    .flower-2 { background: var(--flower-yellow); top: 20%; right: 8%; animation-delay: -1s; }
    .flower-3 { background: var(--flower-purple); top: 60%; left: 3%; animation-delay: -2s; }
    .flower-4 { background: var(--flower-orange); top: 70%; right: 5%; animation-delay: -3s; }
    .flower-5 { background: var(--flower-pink); top: 85%; left: 15%; animation-delay: -4s; }
    .flower-6 { background: var(--flower-yellow); top: 5%; left: 20%; animation-delay: -0.5s; }
    .flower-7 { background: var(--flower-purple); top: 80%; right: 20%; animation-delay: -2.5s; }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      25% { transform: translateY(-10px) rotate(5deg); }
      50% { transform: translateY(-5px) rotate(-3deg); }
      75% { transform: translateY(-15px) rotate(2deg); }
    }

    .stage{max-width:900px;width:100%;position:relative;z-index:2;}

    /* LOCK / PASSWORD SCREEN */
    .screen{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      box-sizing:border-box;
      z-index:10;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    .screen.hidden{
      opacity:0;
      transform:scale(0.9);
      pointer-events:none;
    }

    /* Password Screen */
    .password-screen{
      background:linear-gradient(180deg, rgba(26,13,46,0.85), rgba(22,33,62,0.9));
      backdrop-filter: blur(8px);
    }

    .lock-card{
      background:linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      border-radius:20px;
      padding:32px;
      max-width:450px;
      width:100%;
      box-shadow:0 20px 40px rgba(0,0,0,0.3);
      text-align:center;
      border:1px solid rgba(255,255,255,0.1);
    }

    .lock-card h1{
      margin:0 0 8px;
      font-size:28px;
      font-family: 'Dancing Script', cursive;
      font-weight:700;
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }

    .lock-card p{
      margin:0 0 24px;
      color:#e2e8f0;
      font-family: 'Dancing Script', cursive;
      font-size:18px;
      font-weight:600;
    }

    .pw{display:flex;gap:12px;align-items:stretch;}

    .pw input{
      flex:1;
      padding:14px 16px;
      border-radius:12px;
      border:2px solid rgba(255,107,157,0.3);
      background:rgba(255,255,255,0.05);
      color:inherit;
      font-size:16px;
      font-family: 'Dancing Script', cursive;
      font-weight:600;
      transition:border-color 0.3s ease;
    }

    .pw input:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 3px rgba(255,107,157,0.1);
    }

    .pw button{
      padding:14px 20px;
      border-radius:12px;
      border:none;
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      color:#fff;
      cursor:pointer;
      font-weight:600;
      font-family: 'Dancing Script', cursive;
      font-size:16px;
      transition:transform 0.2s ease;
    }

    .pw button:hover{
      transform:translateY(-1px);
    }

    .small{
      font-size:13px;
      color:#94a3b8;
      margin-top:16px;
      line-height:1.4;
    }

    /* Envelope Screen */
    .envelope-screen{
      background:transparent;
    }

    .envelope-container{
      max-width:600px;
      width:90%;
      position:relative;
      cursor:pointer;
      transition:transform 0.3s ease;
    }

    .envelope-container:hover{
      transform:scale(1.02);
    }

    .envelope{
      position:relative;
      aspect-ratio:16/10;
      margin:0 auto;
    }

    .envelope-body{
      width:100%;
      height:100%;
      background:linear-gradient(180deg,#fff9f9,#fff2f5);
      border-radius:12px;
      box-shadow:0 15px 50px rgba(0,0,0,0.4);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      border:2px solid rgba(255,255,255,0.1);
    }

    .envelope-flap{
      position:absolute;
      top:-2%;
      left:50%;
      transform:translateX(-50%);
      width:84%;
      height:35%;
      background:linear-gradient(180deg,#ffe1ea,#ffd5e3);
      clip-path:polygon(0 0,100% 0,50% 100%);
      border-radius:8px 8px 0 0;
      animation:flapPulse 3s ease-in-out infinite;
    }

    @keyframes flapPulse {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-2px); }
    }

    .envelope-content{
      text-align:center;
      padding:20px;
    }

    .heart-icon{
      width:60px;
      height:60px;
      border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:30px;
      color:#fff;
      margin:0 auto 16px;
      animation:heartBeat 2s ease-in-out infinite;
    }

    @keyframes heartBeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .envelope-title{
      font-family: 'Dancing Script', cursive;
      font-size:28px;
      font-weight:700;
      color:#0b1220;
      margin:0 0 8px;
    }

    .envelope-subtitle{
      color:#6b7280;
      font-size:16px;
      margin:0 0 20px;
    }

    .click-hint{
      display:inline-block;
      padding:12px 24px;
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      color:#fff;
      border-radius:25px;
      font-family: 'Dancing Script', cursive;
      font-size:18px;
      font-weight:600;
      animation:bounce 2s ease-in-out infinite;
      border:none;
      cursor:pointer;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-8px); }
      60% { transform: translateY(-4px); }
    }

    /* Letter Viewer Screen */
    .letter-screen{
      background:rgba(0,0,0,0.95);
    }

    .letter-viewer{
      position:relative;
      width:100%;
      height:100%;
      display:flex;
      flex-direction:column;
      max-width:100vw;
      max-height:100vh;
    }

    .letter-header{
      position:absolute;
      top:20px;
      left:20px;
      right:20px;
      z-index:20;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:rgba(0,0,0,0.3);
      padding:12px 20px;
      border-radius:12px;
      backdrop-filter:blur(10px);
    }

    .letter-title{
      font-family: 'Dancing Script', cursive;
      font-size:24px;
      font-weight:700;
      color:#fff;
      margin:0;
    }

    .close-btn{
      background:rgba(255,107,157,0.2);
      border:2px solid var(--accent);
      color:var(--accent);
      border-radius:50%;
      width:40px;
      height:40px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-size:20px;
      transition:all 0.3s ease;
    }

    .close-btn:hover{
      background:var(--accent);
      color:#fff;
      transform:scale(1.1);
    }

    .letter-canvas{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:80px 20px 60px;
      position:relative;
      overflow:hidden;
    }

    .letter-image{
      max-width:100%;
      max-height:100%;
      width:auto;
      height:auto;
      object-fit:contain;
      border-radius:8px;
      box-shadow:0 20px 60px rgba(0,0,0,0.5);
      transform-origin:center center;
      transition:transform 0.3s ease;
      cursor:grab;
      user-select:none;
    }

    .letter-image:active{
      cursor:grabbing;
    }

    .letter-controls{
      position:absolute;
      bottom:20px;
      left:50%;
      transform:translateX(-50%);
      display:flex;
      gap:8px;
      background:rgba(0,0,0,0.3);
      padding:12px;
      border-radius:12px;
      backdrop-filter:blur(10px);
    }

    .control-btn{
      padding:8px 12px;
      border-radius:8px;
      border:0;
      background:rgba(255,255,255,0.1);
      color:#fff;
      cursor:pointer;
      font-size:14px;
      transition:all 0.2s ease;
      border:1px solid transparent;
    }

    .control-btn:hover{
      background:rgba(255,255,255,0.2);
      transform:translateY(-1px);
    }

    .control-btn.primary{
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      border-color:var(--accent);
    }

    /* Mobile optimizations */
    @media (max-width:768px){
      body{padding:8px;}
      
      .lock-card{
        padding:24px 20px;
        margin:0 8px;
      }
      
      .lock-card h1{font-size:24px;}
      
      .lock-card p{font-size:16px;}
      
      .pw{
        flex-direction:column;
        gap:8px;
      }
      
      .pw input, .pw button{
        width:100%;
        padding:12px 16px;
      }
      
      .envelope-container{width:95%;}
      
      .envelope-title{font-size:24px;}
      
      .click-hint{
        font-size:16px;
        padding:10px 20px;
      }
      
      .letter-header{
        top:10px;
        left:10px;
        right:10px;
        padding:8px 12px;
      }
      
      .letter-title{font-size:20px;}
      
      .letter-canvas{
        padding:60px 10px 50px;
      }
      
      .letter-controls{
        bottom:10px;
        padding:8px;
        gap:6px;
      }
      
      .control-btn{
        padding:6px 10px;
        font-size:12px;
      }
      
      /* Hide some flowers on mobile */
      .flower-decoration:nth-child(n+5){display:none;}
    }

    @media (max-width:480px){
      .envelope-title{font-size:20px;}
      
      .heart-icon{
        width:50px;
        height:50px;
        font-size:24px;
      }
    }

    /* Animation classes */
    .fade-in{
      animation:fadeIn 0.6s ease forwards;
    }

    .scale-in{
      animation:scaleIn 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }

  </style>

</head>

<body>

  <!-- Decorative flowers -->
  <div class="flower-decoration flower-1"><div class="flower"></div></div>
  <div class="flower-decoration flower-2"><div class="flower"></div></div>
  <div class="flower-decoration flower-3"><div class="flower"></div></div>
  <div class="flower-decoration flower-4"><div class="flower"></div></div>
  <div class="flower-decoration flower-5"><div class="flower"></div></div>
  <div class="flower-decoration flower-6"><div class="flower"></div></div>
  <div class="flower-decoration flower-7"><div class="flower"></div></div>

  <!-- Password Screen -->
  <div class="screen password-screen" id="passwordScreen">
    <div class="lock-card fade-in">
      <h1>Private Letter</h1>
      <p>Please enter password</p>
      <div class="pw">
        <input id="pwInput" type="password" placeholder="Enter password" autocomplete="off" />
        <button id="pwBtn">Open</button>
      </div>
      <div class="small">This is a client-side password (keeps casual snoopers out). For stronger protection you would need a server-side check.</div>
    </div>
  </div>

  <!-- Envelope Screen -->
  <div class="screen envelope-screen hidden" id="envelopeScreen">
    <div class="envelope-container scale-in" id="envelopeContainer">
      <div class="envelope">
        <div class="envelope-flap"></div>
        <div class="envelope-body">
          <div class="envelope-content">
            <div class="heart-icon">♥</div>
            <h2 class="envelope-title">For you, my love</h2>
            <p class="envelope-subtitle">A special message awaits inside</p>
            <button class="click-hint">Click to open</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Letter Viewer Screen -->
  <div class="screen letter-screen hidden" id="letterScreen">
    <div class="letter-viewer">
      <div class="letter-header">
        <h3 class="letter-title">My Love Letter</h3>
        <button class="close-btn" id="closeBtn">×</button>
      </div>
      
      <div class="letter-canvas" id="letterCanvas">
        <img class="letter-image" id="letterImg" src="letter.jpg" alt="Love Letter" />
      </div>
      
      <div class="letter-controls">
        <button class="control-btn" id="zoomOut">−</button>
        <button class="control-btn primary" id="fitBtn">Fit</button>
        <button class="control-btn" id="zoomIn">+</button>
        <button class="control-btn" id="downloadBtn">Download</button>
        <button class="control-btn" id="fullscreenBtn">Fullscreen</button>
      </div>
    </div>
  </div>

<script>

// ======= CONFIG (edit these) ========
const PASSWORD_HASH = '947b520658bff4a795be062f0a17d83b91d3b2fbb524925513caad4cac4acc93';
const SALT = 'MySecretSalt123';
const LETTER_FILENAME = 'letter.jpg';

// =====================================

// Screen elements
const passwordScreen = document.getElementById('passwordScreen');
const envelopeScreen = document.getElementById('envelopeScreen');
const letterScreen = document.getElementById('letterScreen');

// Password elements
const pwInput = document.getElementById('pwInput');
const pwBtn = document.getElementById('pwBtn');

// Envelope elements
const envelopeContainer = document.getElementById('envelopeContainer');

// Letter elements
const letterImg = document.getElementById('letterImg');
const closeBtn = document.getElementById('closeBtn');
const letterCanvas = document.getElementById('letterCanvas');
const zoomIn = document.getElementById('zoomIn');
const zoomOut = document.getElementById('zoomOut');
const fitBtn = document.getElementById('fitBtn');
const downloadBtn = document.getElementById('downloadBtn');
const fullscreenBtn = document.getElementById('fullscreenBtn');

// Set image source
letterImg.src = LETTER_FILENAME;

// Helper: sha256 hex
async function sha256Hex(str){
  const enc = new TextEncoder();
  const data = enc.encode(str);
  const hash = await crypto.subtle.digest('SHA-256', data);
  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

// Screen transitions
function showScreen(screen) {
  // Hide all screens
  [passwordScreen, envelopeScreen, letterScreen].forEach(s => s.classList.add('hidden'));
  
  // Show target screen after a brief delay
  setTimeout(() => {
    screen.classList.remove('hidden');
  }, 100);
}

// Password validation
async function checkPassword(){
  const pw = pwInput.value || '';
  const h = await sha256Hex(pw + SALT);
  
  if(h === PASSWORD_HASH){
    showScreen(envelopeScreen);
  } else {
    pwInput.value = '';
    pwInput.placeholder = 'Wrong — try again';
    pwInput.style.borderColor = '#ff4757';
    setTimeout(() => {
      pwInput.style.borderColor = '';
      pwInput.placeholder = 'Enter password';
    }, 1000);
    pwInput.focus();
  }
}

// Event listeners for password
pwBtn.addEventListener('click', checkPassword);
pwInput.addEventListener('keyup', (e) => {
  if(e.key === 'Enter') checkPassword();
});

// Envelope click to open letter
envelopeContainer.addEventListener('click', () => {
  showScreen(letterScreen);
  setTimeout(() => {
    fitToScreen();
  }, 200);
});

// Close letter
closeBtn.addEventListener('click', () => {
  showScreen(envelopeScreen);
  resetZoom();
});

// Letter zoom and pan functionality
let scale = 1;
let translateX = 0;
let translateY = 0;
let isDragging = false;
let lastX = 0;
let lastY = 0;

function updateTransform() {
  letterImg.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
}

function resetZoom() {
  scale = 1;
  translateX = 0;
  translateY = 0;
  updateTransform();
}

function fitToScreen() {
  const canvas = letterCanvas;
  const img = letterImg;
  
  if (!img.naturalWidth || !img.naturalHeight) return;
  
  const canvasRect = canvas.getBoundingClientRect();
  const canvasWidth = canvasRect.width - 40; // padding
  const canvasHeight = canvasRect.height - 40;
  
  const imgAspect = img.naturalWidth / img.naturalHeight;
  const canvasAspect = canvasWidth / canvasHeight;
  
  if (imgAspect > canvasAspect) {
    scale = canvasWidth / img.naturalWidth;
  } else {
    scale = canvasHeight / img.naturalHeight;
  }
  
  // Don't scale up too much
  scale = Math.min(scale, 1.2);
  
  translateX = 0;
  translateY = 0;
  updateTransform();
}

// Control buttons
zoomIn.addEventListener('click', () => {
  scale = Math.min(scale * 1.3, 4);
  updateTransform();
});

zoomOut.addEventListener('click', () => {
  scale = Math.max(scale / 1.3, 0.3);
  updateTransform();
});

fitBtn.addEventListener('click', fitToScreen);

downloadBtn.addEventListener('click', () => {
  const a = document.createElement('a');
  a.href = letterImg.src;
  a.download = 'love-letter.jpg';
  document.body.appendChild(a);
  a.click();
  a.remove();
});

fullscreenBtn.addEventListener('click', () => {
  if (!document.fullscreenElement) {
    letterScreen.requestFullscreen().catch(() => {});
  } else {
    document.exitFullscreen().catch(() => {});
  }
});

// Mouse/touch interactions for pan and zoom
letterCanvas.addEventListener('pointerdown', (e) => {
  isDragging = true;
  lastX = e.clientX;
  lastY = e.clientY;
  letterCanvas.setPointerCapture(e.pointerId);
  e.preventDefault();
});

letterCanvas.addEventListener('pointermove', (e) => {
  if (!isDragging) return;
  
  const dx = e.clientX - lastX;
  const dy = e.clientY - lastY;
  
  translateX += dx;
  translateY += dy;
  
  lastX = e.clientX;
  lastY = e.clientY;
  
  updateTransform();
});

letterCanvas.addEventListener('pointerup', (e) => {
  isDragging = false;
  letterCanvas.releasePointerCapture(e.pointerId);
});

letterCanvas.addEventListener('pointercancel', () => {
  isDragging = false;
});

// Wheel zoom
letterCanvas.addEventListener('wheel', (e) => {
  e.preventDefault();
  
  const delta = -e.deltaY / 1000;
  const newScale = Math.min(Math.max(scale * (1 + delta), 0.3), 4);
  
  const rect = letterCanvas.getBoundingClientRect();
  const centerX = rect.width / 2;
  const centerY = rect.height / 2;
  
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;
  
  const deltaX = mouseX - centerX;
  const deltaY = mouseY - centerY;
  
  const scaleFactor = newScale / scale;
  
  translateX = translateX * scaleFactor + deltaX * (1 - scaleFactor);
  translateY = translateY * scaleFactor + deltaY * (1 - scaleFactor);
  
  scale = newScale;
  updateTransform();
}, { passive: false });

// Touch pinch zoom
let lastTouchDistance = 0;
let lastTouchCenterX = 0;
let lastTouchCenterY = 0;

letterCanvas.addEventListener('touchstart', (e) => {
  if (e.touches.length === 2) {
    const touch1 = e.touches[0];
    const touch2 = e.touches[1];
    
    lastTouchDistance = Math.hypot(
      touch2.clientX - touch1.clientX,
      touch2.clientY - touch1.clientY
    );
    
    lastTouchCenterX = (touch1.clientX + touch2.clientX) / 2;
    lastTouchCenterY = (touch1.clientY + touch2.clientY) / 2;
  }
});

letterCanvas.addEventListener('touchmove', (e) => {
  if (e.touches.length === 2) {
    e.preventDefault();
    
    const touch1 = e.touches[0];
    const touch2 = e.touches[1];
    
    const distance = Math.hypot(
      touch2.clientX - touch1.clientX,
      touch2.clientY - touch1.clientY
    );
    
    const centerX = (touch1.clientX + touch2.clientX) / 2;
    const centerY = (touch1.clientY + touch2.clientY) / 2;
    
    if (lastTouchDistance > 0) {
      const scaleFactor = distance / lastTouchDistance;
      const newScale = Math.min(Math.max(scale * scaleFactor, 0.3), 4);
      
      const rect = letterCanvas.getBoundingClientRect();
      const deltaX = centerX - rect.left - rect.width / 2;
      const deltaY = centerY - rect.top - rect.height / 2;
      
      const scaleChange = newScale / scale;
      
      translateX = translateX * scaleChange + deltaX * (1 - scaleChange);
      translateY = translateY * scaleChange + deltaY * (1 - scaleChange);
      
      scale = newScale;
      updateTransform();
    }
    
    lastTouchDistance = distance;
    lastTouchCenterX = centerX;
    lastTouchCenterY = centerY;
  }
}, { passive: false });

letterCanvas.addEventListener('touchend', () => {
  lastTouchDistance = 0;
});

// Image load handler
letterImg.addEventListener('load', () => {
  setTimeout(fitToScreen, 100);
});

// Window resize handler
window.addEventListener('resize', () => {
  if (!letterScreen.classList.contains('hidden')) {
    setTimeout(fitToScreen, 100);
  }
});

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if (letterScreen.classList.contains('hidden')) return;
  
  switch(e.key) {
    case 'Escape':
      closeBtn.click();
      break;
    case '=':
    case '+':
      e.preventDefault();
      zoomIn.click();
      break;
    case '-':
      e.preventDefault();
      zoomOut.click();
      break;
    case '0':
      e.preventDefault();
      fitBtn.click();
      break;
    case 'f':
    case 'F11':
      e.preventDefault();
      fullscreenBtn.click();
      break;
  }
});

// Focus password input on load
pwInput.focus();

</script>

</body>

</html>
<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Private Letter â€¢ Open with password</title>

  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>

    :root{
      --bg1:#1a0d2e;
      --bg2:#16213e;
      --accent:#ff6b9d;
      --accent-light:#ffb3d1;
      --flower-pink:#ff7eb3;
      --flower-yellow:#ffd93d;
      --flower-purple:#b388ff;
      --flower-orange:#ff8a65;
    }

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;overflow-x:hidden;}

    body{
      background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 50%,#2d1b3d 100%);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
      min-height:100vh;
      position:relative;
    }

    /* Decorative flowers */
    .flower-decoration {
      position: absolute;
      pointer-events: none;
      z-index: 1;
    }

    .flower {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      position: relative;
      animation: float 6s ease-in-out infinite;
    }

    .flower::before,
    .flower::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
    }

    .flower::before {
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      background: inherit;
    }

    .flower::after {
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      background: inherit;
    }

    .flower-1 { background: var(--flower-pink); top: 10%; left: 5%; animation-delay: 0s; }
    .flower-2 { background: var(--flower-yellow); top: 20%; right: 8%; animation-delay: -1s; }
    .flower-3 { background: var(--flower-purple); top: 60%; left: 3%; animation-delay: -2s; }
    .flower-4 { background: var(--flower-orange); top: 70%; right: 5%; animation-delay: -3s; }
    .flower-5 { background: var(--flower-pink); top: 85%; left: 15%; animation-delay: -4s; }
    .flower-6 { background: var(--flower-yellow); top: 5%; left: 20%; animation-delay: -0.5s; }
    .flower-7 { background: var(--flower-purple); top: 80%; right: 20%; animation-delay: -2.5s; }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      25% { transform: translateY(-10px) rotate(5deg); }
      50% { transform: translateY(-5px) rotate(-3deg); }
      75% { transform: translateY(-15px) rotate(2deg); }
    }

    .stage{max-width:900px;width:100%;position:relative;z-index:2;}

    /* LOCK / PASSWORD */

    .lock-overlay{
      position:absolute;
      inset:0;
      background:linear-gradient(180deg, rgba(26,13,46,0.85), rgba(22,33,62,0.9));
      backdrop-filter: blur(8px);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      box-sizing:border-box;
      z-index:10;
    }

    .lock-card{
      background:linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      border-radius:20px;
      padding:32px;
      max-width:450px;
      width:100%;
      box-shadow:0 20px 40px rgba(0,0,0,0.3);
      text-align:center;
      border:1px solid rgba(255,255,255,0.1);
    }

    .lock-card h1{
      margin:0 0 8px;
      font-size:28px;
      font-family: 'Dancing Script', cursive;
      font-weight:700;
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }

    .lock-card p{
      margin:0 0 24px;
      color:#e2e8f0;
      font-family: 'Dancing Script', cursive;
      font-size:18px;
      font-weight:600;
    }

    .pw{display:flex;gap:12px;align-items:stretch;}

    .pw input{
      flex:1;
      padding:14px 16px;
      border-radius:12px;
      border:2px solid rgba(255,107,157,0.3);
      background:rgba(255,255,255,0.05);
      color:inherit;
      font-size:16px;
      font-family: 'Dancing Script', cursive;
      font-weight:600;
      transition:border-color 0.3s ease;
    }

    .pw input:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 3px rgba(255,107,157,0.1);
    }

    .pw button{
      padding:14px 20px;
      border-radius:12px;
      border:none;
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      color:#fff;
      cursor:pointer;
      font-weight:600;
      font-family: 'Dancing Script', cursive;
      font-size:16px;
      transition:transform 0.2s ease;
    }

    .pw button:hover{
      transform:translateY(-1px);
    }

    .small{
      font-size:13px;
      color:#94a3b8;
      margin-top:16px;
      line-height:1.4;
    }

    /* Envelope + Letter */

    .envelope{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      padding:20px 0;
    }

    .env-wrap{
      width:90%;
      max-width:700px;
      position:relative;
      aspect-ratio:16/10;
      max-height:70vh;
    }

    .envelope .body{
      background:linear-gradient(180deg,#fff9f9,#fff2f5);
      border-radius:12px;
      padding:20px;
      box-shadow:0 15px 50px rgba(0,0,0,0.4);
      transform-origin:top center;
      transition:transform 800ms cubic-bezier(.2,.9,.25,1);
      height:100%;
      display:flex;
      flex-direction:column;
    }

    .envelope .flap{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      top:-2%;
      width:84%;
      height:35%;
      background:linear-gradient(180deg,#ffe1ea,#ffd5e3);
      clip-path:polygon(0 0,100% 0,50% 100%);
      border-radius:8px 8px 0 0;
      transform-origin:top center;
      transition:transform 800ms cubic-bezier(.2,.9,.25,1);
    }

    .env-wrap.opened .flap{
      transform:translateX(-50%) rotateX(180deg) translateY(-8%);
    }

    .env-wrap.opened .body{
      transform:translateY(6%) scale(0.98);
    }

    /* Letter viewer */

    .viewer{
      display:none;
      flex:1;
      margin-top:16px;
      background:linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border-radius:10px;
      padding:12px;
      min-height:0;
    }

    .viewer.active{
      display:flex;
      flex-direction:column;
    }

    .canvas{
      background:#fff;
      border-radius:8px;
      overflow:hidden;
      position:relative;
      touch-action:none;
      flex:1;
      min-height:200px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .canvas img{
      display:block;
      max-width:100%;
      max-height:100%;
      width:auto;
      height:auto;
      object-fit:contain;
      transform-origin:center center;
      user-select:none;
      pointer-events:none;
    }

    /* controls */

    .controls{
      display:flex;
      gap:8px;
      justify-content:center;
      margin-top:12px;
      flex-wrap:wrap;
    }

    .btn{
      padding:8px 12px;
      border-radius:8px;
      border:0;
      background:rgba(255,255,255,0.1);
      color:#fff;
      cursor:pointer;
      font-size:14px;
      transition:background 0.2s ease;
    }

    .btn:hover{
      background:rgba(255,255,255,0.15);
    }

    .btn.strong{
      background:linear-gradient(135deg,var(--accent),var(--accent-light));
      color:#fff;
    }

    /* header section */
    .letter-header{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:16px;
    }

    .heart-icon{
      width:48px;
      height:48px;
      border-radius:10px;
      background:linear-gradient(135deg,#fff,#ffe8ee);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      color:var(--accent);
      font-size:24px;
    }

    .letter-header h2{
      margin:0;
      color:#0b1220;
      font-family: 'Dancing Script', cursive;
      font-size:24px;
      font-weight:700;
    }

    .letter-header p{
      margin:4px 0 0;
      color:#6b7280;
      font-size:14px;
    }

    /* footer */

    .meta{
      margin-top:8px;
      text-align:center;
      color:#a0aec0;
      font-size:12px;
      line-height:1.3;
    }

    /* Mobile optimizations */
    @media (max-width:768px){
      body{padding:12px;}
      
      .env-wrap{
        width:95%;
        aspect-ratio:16/11;
        max-height:60vh;
      }
      
      .envelope .body{padding:16px;}
      
      .lock-card{
        padding:24px 20px;
        margin:0 8px;
      }
      
      .lock-card h1{font-size:24px;}
      
      .lock-card p{font-size:16px;}
      
      .pw{
        flex-direction:column;
        gap:8px;
      }
      
      .pw input, .pw button{
        width:100%;
        padding:12px 16px;
      }
      
      .letter-header{
        flex-direction:column;
        text-align:center;
        gap:8px;
      }
      
      .letter-header h2{font-size:20px;}
      
      .canvas{min-height:150px;}
      
      .controls{gap:6px;}
      
      .btn{
        padding:6px 10px;
        font-size:12px;
      }
      
      /* Hide some flowers on mobile */
      .flower-decoration:nth-child(n+5){display:none;}
    }

    @media (max-width:480px){
      .env-wrap{
        aspect-ratio:4/3;
        max-height:50vh;
      }
      
      .envelope .body{padding:12px;}
      
      .viewer{padding:8px;}
      
      .canvas{min-height:120px;}
    }

  </style>

</head>

<body>

  <!-- Decorative flowers -->
  <div class="flower-decoration flower-1"><div class="flower"></div></div>
  <div class="flower-decoration flower-2"><div class="flower"></div></div>
  <div class="flower-decoration flower-3"><div class="flower"></div></div>
  <div class="flower-decoration flower-4"><div class="flower"></div></div>
  <div class="flower-decoration flower-5"><div class="flower"></div></div>
  <div class="flower-decoration flower-6"><div class="flower"></div></div>
  <div class="flower-decoration flower-7"><div class="flower"></div></div>

  <div class="stage">

    <div class="envelope">

      <div class="env-wrap" id="envWrap">

        <div class="flap" id="flap"></div>

        <div class="body">

          <div class="letter-header">

            <div class="heart-icon">â™¥</div>

            <div>

              <h2>For you, my love</h2>

              <p>Open with the little secret I gave you.</p>

            </div>

          </div>

          <div class="viewer" id="viewer">

            <div class="canvas" id="canvas">

              <img id="letterImg" src="letter.jpg" alt="your letter image"/>

            </div>

            <div class="controls">

              <button class="btn" id="zoomOut">âˆ’</button>

              <button class="btn strong" id="fit">Fit</button>

              <button class="btn" id="zoomIn">+</button>

              <button class="btn" id="download">Download</button>

              <button class="btn" id="fullscreen">Fullscreen</button>

            </div>

            <div class="meta">Tip: pinch to zoom, drag to move (mobile & desktop)</div>

          </div>

        </div>

      </div>

    </div>

    <!-- Password overlay -->

    <div class="lock-overlay" id="lock">

      <div class="lock-card">

        <h1>Private Letter</h1>

        <p>Please enter password</p>

        <div class="pw">

          <input id="pwInput" type="password" placeholder="Enter password" autocomplete="off" />

          <button id="pwBtn">Open</button>

        </div>

        <div class="small">This is a client-side password (keeps casual snoopers out). For stronger protection you would need a server-side check.</div>

      </div>

    </div>

  </div>

<script>

// ======= CONFIG (edit these) ========

const PASSWORD_HASH = '947b520658bff4a795be062f0a17d83b91d3b2fbb524925513caad4cac4acc93';

const SALT = 'MySecretSalt123';

const LETTER_FILENAME = 'letter.jpg';

// =====================================

// helpers: sha256 hex

async function sha256Hex(str){

  const enc = new TextEncoder();

  const data = enc.encode(str);

  const hash = await crypto.subtle.digest('SHA-256', data);

  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');

}

// UI

const lock = document.getElementById('lock');

const pwInput = document.getElementById('pwInput');

const pwBtn = document.getElementById('pwBtn');

const envWrap = document.getElementById('envWrap');

const viewer = document.getElementById('viewer');

const letterImg = document.getElementById('letterImg');

const zoomIn = document.getElementById('zoomIn');

const zoomOut = document.getElementById('zoomOut');

const fitBtn = document.getElementById('fit');

const downloadBtn = document.getElementById('download');

const fullscreenBtn = document.getElementById('fullscreen');

const canvas = document.getElementById('canvas');

// make sure image filename matches

letterImg.src = LETTER_FILENAME;

async function checkPassword(){

  const pw = pwInput.value || '';

  const h = await sha256Hex(pw + SALT);

  if(h === PASSWORD_HASH){

    unlock();

  } else {

    pwInput.value = '';

    pwInput.placeholder = 'Wrong â€” try again';

    pwInput.focus();

  }

}

pwBtn.addEventListener('click', checkPassword);

pwInput.addEventListener('keyup', (e)=>{ if(e.key === 'Enter') checkPassword(); });

function unlock(){

  // animate envelope

  envWrap.classList.add('opened');

  // hide lock overlay with fade

  lock.style.transition = 'opacity 600ms ease';

  lock.style.opacity = '0';

  setTimeout(()=> lock.style.display = 'none', 620);

  // reveal viewer after small delay

  setTimeout(()=> viewer.classList.add('active'), 800);

}

// ====== Enhanced image fitting and zoom ======

let scale = 1, minScale = 0.3, maxScale = 5, startX = 0, startY = 0, translateX = 0, translateY = 0;

function updateTransform(){

  letterImg.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

}

zoomIn.addEventListener('click', ()=>{ 

  scale = Math.min(maxScale, +(scale * 1.3).toFixed(2)); 
  updateTransform(); 
});

zoomOut.addEventListener('click', ()=>{ 
  scale = Math.max(minScale, +(scale / 1.3).toFixed(2)); 
  updateTransform(); 
});

fitBtn.addEventListener('click', ()=>{ fitToContainer(); });

downloadBtn.addEventListener('click', ()=>{

  const a = document.createElement('a');

  a.href = letterImg.src;

  a.download = 'letter.jpg';

  document.body.appendChild(a); a.click(); a.remove();

});

fullscreenBtn.addEventListener('click', ()=>{

  if(!document.fullscreenElement){ 
    canvas.requestFullscreen().catch(()=>{}); 
  } else { 
    document.exitFullscreen().catch(()=>{}); 
  }

});

function fitToContainer(){

  const canvasRect = canvas.getBoundingClientRect();
  const cw = canvasRect.width - 20; // account for padding
  const ch = canvasRect.height - 20;
  
  const iw = letterImg.naturalWidth; 
  const ih = letterImg.naturalHeight;

  if(!iw || !ih) return;

  const scaleX = cw / iw; 
  const scaleY = ch / ih; 
  scale = Math.min(scaleX, scaleY, 1); // don't scale up beyond natural size initially

  // center the image
  translateX = 0;
  translateY = 0;

  updateTransform();

}

// Load handler with proper fitting
letterImg.addEventListener('load', ()=>{ 
  setTimeout(fitToContainer, 100); // small delay to ensure canvas is sized
});

// Resize handler
window.addEventListener('resize', ()=>{
  setTimeout(fitToContainer, 100);
});

// Enhanced pointer-based drag with better bounds

let dragging = false; let lastX=0, lastY=0;

canvas.addEventListener('pointerdown', (e)=>{

  dragging = true; 
  lastX = e.clientX; 
  lastY = e.clientY; 
  canvas.setPointerCapture(e.pointerId);
  e.preventDefault();

});

canvas.addEventListener('pointermove', (e)=>{

  if(!dragging) return;

  const dx = e.clientX - lastX; 
  const dy = e.clientY - lastY; 
  lastX = e.clientX; 
  lastY = e.clientY;

  translateX += dx; 
  translateY += dy; 
  updateTransform();

});

canvas.addEventListener('pointerup', (e)=>{ 
  dragging=false; 
  try{ canvas.releasePointerCapture(e.pointerId);}catch(e){} 
});

canvas.addEventListener('pointercancel', ()=>{ dragging=false });

// Enhanced wheel zoom

canvas.addEventListener('wheel', (e)=>{

  if(e.ctrlKey || e.shiftKey || Math.abs(e.deltaY) > Math.abs(e.deltaX)){

    e.preventDefault();

    const delta = -e.deltaY/800;
    const factor = Math.exp(delta);
    const newScale = Math.min(maxScale, Math.max(minScale, scale * factor));

    // zoom towards cursor

    const rect = canvas.getBoundingClientRect();

    const cx = e.clientX - rect.left - rect.width/2; 
    const cy = e.clientY - rect.top - rect.height/2;

    const scaleFactor = newScale/scale;

    translateX = translateX * scaleFactor + cx * (1 - scaleFactor);
    translateY = translateY * scaleFactor + cy * (1 - scaleFactor);

    scale = newScale; 
    updateTransform();

  }

},{passive:false});

// Enhanced pinch handling

let lastDist = 0; let lastCenterX = 0; let lastCenterY = 0;

canvas.addEventListener('touchstart', (e)=>{

  if(e.touches.length === 2){ 
    lastDist = Math.hypot(
      e.touches[0].clientX - e.touches[1].clientX, 
      e.touches[0].clientY - e.touches[1].clientY
    );
    lastCenterX = (e.touches[0].clientX + e.touches[1].clientX) / 2;
    lastCenterY = (e.touches[0].clientY + e.touches[1].clientY) / 2;
  }

});

canvas.addEventListener('touchmove', (e)=>{

  if(e.touches.length === 2){

    e.preventDefault();

    const d = Math.hypot(
      e.touches[0].clientX - e.touches[1].clientX, 
      e.touches[0].clientY - e.touches[1].clientY
    );
    
    const centerX = (e.touches[0].clientX + e.touches[1].clientX) / 2;
    const centerY = (e.touches[0].clientY + e.touches[1].clientY) / 2;

    if(lastDist && d > 10){

      const factor = d/lastDist; 
      const newScale = Math.min(maxScale, Math.max(minScale, scale * factor));
      
      const rect = canvas.getBoundingClientRect();
      const cx = centerX - rect.left - rect.width/2;
      const cy = centerY - rect.top - rect.height/2;
      
      const scaleFactor = newScale/scale;
      
      translateX = translateX * scaleFactor + cx * (1 - scaleFactor);
      translateY = translateY * scaleFactor + cy * (1 - scaleFactor);

      scale = newScale; 
      updateTransform();

    }

    lastDist = d;
    lastCenterX = centerX;
    lastCenterY = centerY;

  }

},{passive:false});

canvas.addEventListener('touchend', ()=>{ 
  lastDist = 0; 
});

// Accessibility: focus pw input on load

pwInput.focus();

</script>

</body>

</html>
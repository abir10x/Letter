<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Private Letter • Open with password</title>

  <style>

    :root{--bg1:#0f172a;--bg2:#071329;--accent:#ff6b81}

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}

    body{background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#fff;display:flex;align-items:center;justify-content:center;padding:24px}

    .stage{max-width:900px;width:100%;position:relative}

    /* LOCK / PASSWORD */

    .lock-overlay{position:absolute;inset:0;background:linear-gradient(180deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85));backdrop-filter: blur(6px);display:flex;align-items:center;justify-content:center;padding:24px;box-sizing:border-box}

    .lock-card{background:linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:16px;padding:28px;max-width:420px;width:100%;box-shadow:0 8px 30px rgba(2,6,23,0.6);text-align:center}

    .lock-card h1{margin:0 0 12px;font-size:20px}

    .lock-card p{margin:0 0 18px;color:#cbd5e1}

    .pw{display:flex;gap:8px}

    .pw input{flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;font-size:16px}

    .pw button{padding:12px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),#ff8fa3);color:#0b1220;cursor:pointer}

    .small{font-size:13px;color:#94a3b8;margin-top:10px}

    /* Envelope + Letter */

    .envelope{width:100%;aspect-ratio:16/9;max-height:640px;display:flex;align-items:center;justify-content:center;position:relative}

    .env-wrap{width:80%;max-width:760px;position:relative}

    .envelope .body{background:linear-gradient(180deg,#fff7f7,#fff0f2);border-radius:10px;padding:22px;box-shadow:0 12px 40px rgba(3,7,18,0.6);transform-origin:top center;transition:transform 800ms cubic-bezier(.2,.9,.25,1)}

    .envelope .flap{position:absolute;left:50%;transform:translateX(-50%);top:-3%;width:86%;height:38%;background:linear-gradient(180deg,#ffdfe6,#ffd2df);clip-path:polygon(0 0,100% 0,50% 100%);border-radius:6px;transform-origin:top center;transition:transform 800ms cubic-bezier(.2,.9,.25,1)}

    .env-wrap.opened .flap{transform:translateX(-50%) rotateX(180deg) translateY(-6%)}

    .env-wrap.opened .body{transform:translateY(8%) scale(0.98)}

    /* Letter viewer */

    .viewer{display:none;margin-top:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:14px}

    .viewer.active{display:block}

    .canvas{background:#fff;border-radius:8px;overflow:hidden;position:relative;touch-action:none}

    .canvas img{display:block;max-width:none;width:100%;height:auto;transform-origin:0 0;user-select:none;pointer-events:none}

    /* controls */

    .controls{display:flex;gap:8px;justify-content:center;margin-top:12px}

    .btn{padding:10px 12px;border-radius:10px;border:0;background:rgba(255,255,255,0.06);color:#fff;cursor:pointer}

    .btn.strong{background:linear-gradient(90deg,var(--accent),#ff8fa3);color:#081226}

    /* footer */

    .meta{margin-top:12px;text-align:center;color:#93a4bd;font-size:13px}

    @media (max-width:640px){.env-wrap{width:100%}.lock-card{padding:18px}.pw input{padding:10px}.pw button{padding:10px}}

  </style>

</head>

<body>

  <div class="stage">

    <div class="envelope">

      <div class="env-wrap" id="envWrap">

        <div class="flap" id="flap"></div>

        <div class="body">

          <div style="display:flex;align-items:center;gap:12px">

            <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(180deg,#fff,#ffeaea);display:flex;align-items:center;justify-content:center;font-weight:700;color:#ff3b6b">❤</div>

            <div>

              <h2 style="margin:0;color:#0b1220">For you, my love</h2>

              <p style="margin:4px 0 0;color:#6b7280">Open with the little secret I gave you.</p>

            </div>

          </div>

          <div class="viewer" id="viewer">

            <div class="canvas" id="canvas" style="height:480px;">

              <img id="letterImg" src="letter.jpg" alt="your letter image"/>

            </div>

            <div class="controls">

              <button class="btn" id="zoomOut">−</button>

              <button class="btn strong" id="fit">Fit</button>

              <button class="btn" id="zoomIn">+</button>

              <button class="btn" id="download">Download</button>

              <button class="btn" id="fullscreen">Fullscreen</button>

            </div>

            <div class="meta">Tip: pinch to zoom, drag to move (mobile & desktop)</div>

          </div>

        </div>

      </div>

    </div>

    <!-- Password overlay -->

    <div class="lock-overlay" id="lock">

      <div class="lock-card">

        <h1>Private Letter</h1>

        <p>Enter the password I told you to unlock this message.</p>

        <div class="pw">

          <input id="pwInput" type="password" placeholder="Enter password" autocomplete="off" />

          <button id="pwBtn">Open</button>

        </div>

        <div class="small">This is a client-side password (keeps casual snoopers out). For stronger protection you would need a server-side check.</div>

      </div>

    </div>

  </div>

<script>

// ======= CONFIG (edit these) ========

const PASSWORD_HASH = '947b520658bff4a795be062f0a17d83b91d3b2fbb524925513caad4cac4acc93';

const SALT = 'MySecretSalt123';

const LETTER_FILENAME = 'letter.jpg';

// =====================================

// helpers: sha256 hex

async function sha256Hex(str){

  const enc = new TextEncoder();

  const data = enc.encode(str);

  const hash = await crypto.subtle.digest('SHA-256', data);

  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');

}

// UI

const lock = document.getElementById('lock');

const pwInput = document.getElementById('pwInput');

const pwBtn = document.getElementById('pwBtn');

const envWrap = document.getElementById('envWrap');

const viewer = document.getElementById('viewer');

const letterImg = document.getElementById('letterImg');

const zoomIn = document.getElementById('zoomIn');

const zoomOut = document.getElementById('zoomOut');

const fitBtn = document.getElementById('fit');

const downloadBtn = document.getElementById('download');

const fullscreenBtn = document.getElementById('fullscreen');

const canvas = document.getElementById('canvas');

// make sure image filename matches

letterImg.src = LETTER_FILENAME;

async function checkPassword(){

  const pw = pwInput.value || '';

  const h = await sha256Hex(pw + SALT);

  if(h === PASSWORD_HASH){

    unlock();

  } else {

    pwInput.value = '';

    pwInput.placeholder = 'Wrong — try again';

    pwInput.focus();

  }

}

pwBtn.addEventListener('click', checkPassword);

pwInput.addEventListener('keyup', (e)=>{ if(e.key === 'Enter') checkPassword(); });

function unlock(){

  // animate envelope

  envWrap.classList.add('opened');

  // hide lock overlay with fade

  lock.style.transition = 'opacity 400ms';

  lock.style.opacity = '0';

  setTimeout(()=> lock.style.display = 'none', 420);

  // reveal viewer after small delay

  setTimeout(()=> viewer.classList.add('active'), 700);

}

// ====== Simple image pan & zoom ======

let scale = 1, minScale = 0.5, maxScale = 4, startX = 0, startY = 0, translateX = 0, translateY = 0;

function updateTransform(){

  letterImg.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

}

zoomIn.addEventListener('click', ()=>{ scale = Math.min(maxScale, +(scale+0.25).toFixed(2)); updateTransform(); });

zoomOut.addEventListener('click', ()=>{ scale = Math.max(minScale, +(scale-0.25).toFixed(2)); updateTransform(); });

fitBtn.addEventListener('click', ()=>{ fitToContainer(); });

downloadBtn.addEventListener('click', ()=>{

  const a = document.createElement('a');

  a.href = letterImg.src;

  a.download = 'letter.jpg';

  document.body.appendChild(a); a.click(); a.remove();

});

fullscreenBtn.addEventListener('click', ()=>{

  if(!document.fullscreenElement){ canvas.requestFullscreen().catch(()=>{}); }

  else document.exitFullscreen().catch(()=>{});

});

function fitToContainer(){

  // fit width to canvas width

  const cw = canvas.clientWidth; const ch = canvas.clientHeight;

  const iw = letterImg.naturalWidth; const ih = letterImg.naturalHeight;

  if(!iw || !ih) return;

  const scaleX = cw / iw; const scaleY = ch / ih; scale = Math.min(scaleX, scaleY);

  // center

  translateX = (cw - iw*scale)/2; translateY = (ch - ih*scale)/2;

  updateTransform();

}

letterImg.addEventListener('load', ()=>{ fitToContainer(); });

// Pointer-based drag

let dragging = false; let lastX=0, lastY=0;

canvas.addEventListener('pointerdown', (e)=>{

  dragging = true; lastX = e.clientX; lastY = e.clientY; canvas.setPointerCapture(e.pointerId);

});

canvas.addEventListener('pointermove', (e)=>{

  if(!dragging) return;

  const dx = e.clientX - lastX; const dy = e.clientY - lastY; lastX = e.clientX; lastY = e.clientY;

  translateX += dx; translateY += dy; updateTransform();

});

canvas.addEventListener('pointerup', (e)=>{ dragging=false; try{ canvas.releasePointerCapture(e.pointerId);}catch(e){} });

canvas.addEventListener('pointercancel', ()=>{ dragging=false });

// Wheel to zoom (ctrl+wheel or wheel on desktop)

canvas.addEventListener('wheel', (e)=>{

  if(e.ctrlKey || e.shiftKey || e.deltaY){

    e.preventDefault();

    const delta = -e.deltaY/500; // small increment

    const newScale = Math.min(maxScale, Math.max(minScale, +(scale*(1+delta)).toFixed(3)));

    // zoom towards cursor

    const rect = canvas.getBoundingClientRect();

    const cx = e.clientX - rect.left; const cy = e.clientY - rect.top;

    const dx = (cx - translateX); const dy = (cy - translateY);

    const factor = newScale/scale;

    translateX -= (factor-1)*dx; translateY -= (factor-1)*dy;

    scale = newScale; updateTransform();

  }

},{passive:false});

// Basic pinch handling for mobile

let lastDist = 0;

canvas.addEventListener('touchstart', (e)=>{

  if(e.touches.length === 2){ lastDist = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY); }

});

canvas.addEventListener('touchmove', (e)=>{

  if(e.touches.length === 2){

    e.preventDefault();

    const d = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY);

    if(lastDist){

      const factor = d/lastDist; const newScale = Math.min(maxScale, Math.max(minScale, +(scale*factor).toFixed(3)));

      scale = newScale; updateTransform();

    }

    lastDist = d;

  }

},{passive:false});

canvas.addEventListener('touchend', ()=>{ lastDist = 0; });

// Accessibility: focus pw input on load

pwInput.focus();

</script>

</body>

</html>
